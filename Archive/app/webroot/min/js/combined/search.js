!function(){define(["utilities/global","controllers/application"],function(){var a=window.LSP,b=a.utilities;b.register("model","api",{_timeout:15e3,_url:function(){return""},_payload:function(a,b){return b},_isSuccess:function(a){return(a||{}).success===!0},_afterSuccess:function(a){return a},_request:function(c,d,e,f,g,h){var i=$.Deferred(),j={};return $.support.cors=!0,j.xhrData={type:c,url:this._url(e,g),data:this._payload(e,g),crossDomain:!0,dataType:d,context:this,timeout:this._timeout,passthrough:$.extend({},h)},console.log("API Request Sent via "+f,j.xhrData),$(a.controllers.application).triggerHandler("onBeforeAPICall",j),$(e).triggerHandler("onBeforeAPICall",j),$(e).triggerHandler(b.camelCase("on-Before-API-"+f+"-call"),j),$.ajax(j.xhrData).done(function(a){j.serverResponse=a;try{j.response=$.parseJSON(a)}catch(b){j.response=a}this._isSuccess(a)?(j.response=this._afterSuccess(j.response),i.resolve(j)):(j.error="invalidFormat",i.reject(j))}).fail(function(a){j.serverResponse=a;try{j.response=$.parseJSON(a.responseText)}catch(b){j.response=a}i.reject(j)}).always(function(){console.log("API Response Recieved via "+f,j)}),$.when(i).done(function(c){$(a.controllers.application).triggerHandler("onAfterAPICallSuccess",c),$(e).triggerHandler("onAfterAPICallSuccess",c),$(e).triggerHandler(b.camelCase("on-after-API-"+f+"-success"),c)}).fail(function(c){$(a.controllers.application).triggerHandler("onAfterAPICallFailure",c),$(e).triggerHandler("onAfterAPICallFailure",c),$(e).triggerHandler(b.camelCase("on-after-API-"+f+"-failure"),c)}).always(function(c){$(a.controllers.application).triggerHandler("onAfterAPICall",c),$(e).triggerHandler("onAfterAPICall",c),$(e).triggerHandler(b.camelCase("on-after-API-"+f),c)}),i.promise()},request:function(a,b,c,d){return this._request("GET","jsonp",a,b,c,d)}})})}();;!function(){define(["utilities/global","controllers/application","models/api"],function(){var a=window.LSP.utilities,b=window.LSP.models;a.register("model","easyask",function(){var c,d=$.extend({},b.api),e="nslonestarpercussion",f="http://lonestarpercussion.prod.easyaskondemand.com",g={};return $.extend(d,{_timeout:3e4,_url:function(){return f+"/EasyAsk/apps/Advisor.jsp"},_payload:function(b,c){var f={RequestAction:c.action,RequestData:c.method,currentpage:c.page||1,forcepage:1,ResultsPerPage:c.resultsPerPage||24,defsortcols:"default"===c.sort?"":c.sort,indexed:1,rootprods:1,oneshot:1,defarrangeby:"///NONE///",disp:"json",dct:e,q:c.keywords&&c.keywords.length?c.keywords:void 0,AttribSel:d.combineSimilarAttributesForRequest(c.attribute,c.allAttributes)};return f.CatPath=a.cleanArray([(c.category||"").replace("All Products",""),d.combineAndRemoveAllForPath(c.attribute,c.allAttributes),this.buildKeywordString(c.keywords)]).join("/").replace(/^\/{1,}-/,"-"),$.isEmptyObject(c.allAttributes)&&!c.attribute&&"CA_AttributeSelected"===c.method&&(f.RequestData="CA_BreadcrumbClick"),"CA_BreadcrumbRemove"!==f.RequestData||f.q||f.AttribSel||(f.RequestData="CA_CategoryExpand"),"CA_Search"!==f.RequestData&&delete f.q,(f.ResultsPerPage>96||"all"===(f.ResultsPerPage+""||"").toLowerCase())&&(f.ResultsPerPage=96),f.CatPath=f.CatPath.replace(/\/$/,"").replace(/^\//,"").replace(/\/\//g,"/"),f},_isSuccess:function(a){return 0===(a||{}).returnCode},isRedirect:function(a){return/((http|https)(:\/\/))?([a-zA-Z0-9]+[.]{1}){2}[a-zA-z0-9]+(\/{1}[a-zA-Z0-9]+)*\/?/.test(a.errorMsg)||/^\//.test(a.errorMsg)},_afterSuccess:function(a){if(d.isRedirect(a))return void(document.location=a.errorMsg);c=a.sessionID,a.source=d.clean(a.source),a.source.navPath._lsp=a.source.navPath._lsp||{},a.source.navPath._lsp.categoryNodes=d.getCategoryNodes(a.source),a.source.navPath._lsp.refinementNodes=d.getRefinementNodes(a.source),a.source.navPath._lsp.searchNode=d.getSearchNode(a.source),this.cacheAttributes(a.source),a.source.attributes=a.source.attributes||{},a.source.attributes._lsp=a.source.attributes._lsp||{},a.source.attributes._lsp.cached=d.injectCachedAttributes(a.source),a.source._lsp=a.source._lsp||{},a.source._lsp.query=d.parseCommentaryForDidYouMean(a.source.commentary);for(var b=0;b<((a.source.products||{}).items||{}).length;b++)if(a.source.products.items[b].Matrix_Values){var e=$.parseJSON(a.source.products.items[b].Matrix_Values);a.source.products.items[b]._formattedMatrixObject=d.parseMatrixChildren(e)}return a},clean:function(a){for(var b=0;b<((a.categories||{}).categoryList||[]).length;b++)"Schools"===a.categories.categoryList[b].name&&(a.categories.categoryList.splice(b,1),b--);for(var c,b=0;b<((a.attributes||{}).attribute||{}).length;b++){for(var d=0;d<(a.attributes.attribute[b].attributeValueList||{}).length;d++)c=a.attributes.attribute[b].attributeValueList[d].attributeValue,("!"===c.substr(0,1)||"None"===c||"Unknown"===c||"Required"===c)&&(a.attributes.attribute[b].attributeValueList.splice(d,1),d--);for(var d=0;d<(a.attributes.attribute[b].initialAttributeValueList||{}).length;d++)c=a.attributes.attribute[b].initialAttributeValueList[d].attributeValue,("!"===c.substr(0,1)||"None"===c||"Unknown"===c||"Required"===c)&&(a.attributes.attribute[b].initialAttributeValueList.splice(d,1),a.attributes.attribute[b].initDispLimit--,d--);0===a.attributes.attribute[b].attributeValueList.length&&(a.attributes.attribute.splice(b,1),b--)}return 0===((a.attributes||{}).attribute||[]).length&&delete a.attributes,a},combineAndRemoveAllForPath:function(a,b){if(b&&a){var c=a.replace(/:.*/,"");b=b.split("/");for(var d=0;d<b.length;d++)b[d].replace(/:.*/,"")===c&&(b.splice(d,1),d--);return b.join("/")}return b},combineSimilarAttributesForRequest:function(a,b){if(b&&a){var c=a.replace(/:.*/,"");b=b.split("/");for(var d=0;d<b.length;d++)b[d].replace(/:.*/,"")===c&&(a+=";"+b[d]);return a}return a},buildKeywordString:function(a){return a?("-"+a).replace(/-{1,}/,"-"):null},buildSingleAttributeString:function(a){return this.buildMultiAttributeString(a).replace("AttribSelect=","").replace(/\/\/\/\/*/,"")},clearCachedAttributes:function(){g={}},cacheAttributes:function(a){var b={};$.each(g,function(a,b){g[b.attribute.name].isFromCached=!0});for(var c=0;c<((a.attributes||{}).attribute||{}).length;c++){var d=a.attributes.attribute[c];g[d.name]={index:c,attribute:d,isFromCached:!1},b[d.name]=!0}return $.each(g,function(c,d){var e=$(a.navPath.navPathNodeList).last()[0].seoPath,f=d.attribute.attributeValueList[0].nodeString.replace(/:.*/,"");!b[d.attribute.name]&&e.indexOf(f+":")<0&&delete g[d.attribute.name]}),b},injectCachedAttributes:function(a){var b=[],c=[];return $.each(g,function(a,b){c.push(b)}),c.sort(function(a,b){return a.index<b.index?-1:a.index>b.index?1:a.isFromCached&&!b.isFromCached?-1:b.isFromCached&&!a.isFromCached?1:0}),$.each(c,function(c,d){for(var e=!1,f=0;f<((a.attributes||{}).attribute||{}).length;f++)a.attributes.attribute[f].attributeName===d.attribute.name&&(e=!0,b.push(a.attributes.attribute[f]));e||b.push(d.attribute)}),this.markSelectedAttributes(a,b)},markSelectedAttributes:function(a,b){var b=$.extend(!0,[],b);return $.each(((a.navPath||{})._lsp||{}).refinementNodes,function(a,c){for(var d=0;d<(b||{}).length;d++)if((b[d]||{}).name===c.attribute){for(var a=0;a<(b[d].attributeValueList||{}).length;a++)if(c.value===b[d].attributeValueList[a].attributeValue){b[d].attributeValueList[a].selected=!0;break}break}}),b},getCategoryNodes:function(a){for(var b=[],c=a.navPath.navPathNodeList,d=this.getCategoriesFromSEOPath(c[c.length-1].seoPath),e=0;e<a.navPath.navPathNodeList.length;e++)if(1===c[e].navNodePathType&&(c[e].englishName=c[e].englishName.replace(/\/$/,""),c[e].englishName="All-Products"===c[e].englishName?"All Products":c[e].englishName,"All Products"!==c[e].englishName&&"School"!==c[e].englishName)){var f=b.push(c[e]),g=b[f-1].seoPath;b[f-1].removePath=d.substr(d.indexOf(g)+g.length,d.length)}return b},getSearchNode:function(a){for(var b=0;b<a.navPath.navPathNodeList.length;b++)if(3===a.navPath.navPathNodeList[b].navNodePathType)return a.navPath.navPathNodeList[b]},getRefinementNodes:function(b){for(var c=[],d=0;d<b.navPath.navPathNodeList.length;d++){var e=b.navPath.navPathNodeList[d];if(2===e.navNodePathType){var f=(decodeURIComponent(b.navPath.fullPath).replace(/\+/g," "),e.englishName.substring(1,e.englishName.length-2));f=f.split("'); (");for(var g=0;g<f.length;g++)for(var h=f[g].split("' or "),i=0;i<h.length;i++){var j=h[i].split(" = '"),k=this.convertToSEOString(j[0]+":"+j[1]),l=a.findBetween(k,";",e.seoPath);c.push({attribute:j[0],value:j[1],nodeString:k+l})}}}return c},parseMatrixChildren:function(a){for(var b={},c={},a=("string"==typeof a?$.parseJSON(a):a)||[],d=0;d<a.length;d++){var e=a[d][0],f=a[d][1].split("|"),g=f[0],h=f[1],i=(f[2],f[3]),j=f[4],k=f[5],l=f[6],m=f[7];waysToSave=f[8],specialFeature=f[9],b[g]=b[g]||{},b[g][h]=b[g][h]||[],b[g][h].push(e),c[e]=c[e]||{},c[e].options=c[e].options||{},c[e].options[g]=c[e].options[g]||{},c[e].options[g]=h,c[e].data=c[e].data||{},c[e].data.imageUrl=i,c[e].data.mpn=j,c[e].data.onlinePrice=k,c[e].data.msrp=l,c[e].data.stockMessage=m,c[e].data.waysToSave=waysToSave,c[e].data.specialFeature=specialFeature}return{options:b,products:c}},filterMatrixChildren:function(a,b){var c={},d={};return $.each(a.products,function(a,c){for(var e in b)if(b.hasOwnProperty(e)&&c.options[e]&&c.options[e]!=b[e])return;d[a]=c}),$.each(d,function(a,d){$.each(d.options,function(d,e){b[d]||(c[d]=c[d]||{},c[d][e]=c[d][e]||[],c[d][e].push(a))})}),c},convertToSEOString:function(a){return a.replace(/'/g,"").replace(/[^A-Za-z0-9:]/g,"-").replace(/-{1,}/g,"-").replace(/-$/,"").replace(/:-/,":")},getCategoriesFromSEOPath:function(a){for(var a=a.split("/"),b=0;b<a.length;b++)(a[b].indexOf(":")>0||0===a[b].indexOf("-"))&&(a.splice(b,1),b--);return a.join("/")},getRefinementsFromSEOPath:function(a){for(var a=a.split("/"),b=0;b<a.length;b++)(a[b].indexOf(":")<0||0===a[b].indexOf("-"))&&(a.splice(b,1),b--);return a.join("/")},getKeywordsFromSEOPath:function(a){for(var a=unescape(a).split("/"),b=0;b<a.length;b++)if(0===a[b].indexOf("-"))return encodeURIComponent(a[b]);return""},parseCommentaryForDidYouMean:function(b){var c={};if(b.length>0&&b.indexOf("Corrected Word")>-1){{b.split(" ")}c.originalQuery=a.findBetween("Corrected Word: "," is ",b),c.assumedQuery=a.findBetween(" is ","; ",b),c.otherSuggestions=(a.findBetween(" could be  ","~END",b+"~END")||"").split(", ")}return c}})}())})}();;!function(){define(["utilities/global","controllers/application","models/api","models/easyask"],function(){var a=window.LSP.utilities;a.register("controller","search",function(){var b={},c=window.LSP,d=c.models.easyask,e=!1,f=!0,g={},h=[],i={};return b={events:{search:{onBeforeAPICall:function(){var a=$("#templates-search-page");if(!a.length)return alert("Unfortunately it appears the templates can't be loaded, please call to complete your order"),_gaq.push(["_trackEvent","search","error","templatesCannotBeLoaded"]),!1;$(".page-generic").height();$(".page-search").addClass("loading")},onAfterAPICall:function(){$(".page-search, .page-generic").removeClass("loading"),$("html").removeClass("search-loading"),f=!1},onAfterAPICallSuccess:function(a,c){if(c.response){var e=c.response.source.navPath.navPathNodeList;g.category=d.getCategoriesFromSEOPath(e[e.length-1].seoPath).replace(/\/$/,""),g.category=g.category.replace(/\/.*\/.*\//,"/"),g.allAttributes=d.getRefinementsFromSEOPath(e[e.length-1].seoPath).replace(/\/$/,""),g.keywords=decodeURIComponent(d.getKeywordsFromSEOPath(e[e.length-1].seoPath).replace(/\-/g," ").replace(/^ /,"")),g.page=((c.response.source.products||{}).itemDescription||{}).currentPage,i=c,$.when(b.scrollToFirst()).done(function(){c.xhrData.passthrough.preventPushState||b.pushState()})}},onAfterAPICallFailure:function(a,c){b.renderFatalError(c)},onRemoveFilter:function(a,c){var d=$(c.selector).data("attribute");$('#refinementForm input[name="'+d+'[]"][value="'+$(c.selector).data("value")+'"]').attr("checked",!1),b.updateHistoryMap(d),b.removeFilterAttribute($(c.selector).data("value"));var e=$(c.selector).data("value").split(":");_gaq.push(["_trackEvent","search","removeFilterAttribute",e[0],e[1]])},onSearch:function(a,c){var d=$('input[name="searchQuery"]',c.selector).trigger("blur").val()||"";d.length>0&&(-1===document.location.href.indexOf("https")?($(".mobileSearch .b3").click(),("undefined"!==d&&d.length||g.keywords&&(g.keywords||{}).length)&&(delete g.category,delete g.allAttributes,f=!1,g.keywords=d,b.search(d))):document.location="http://www.lonestarpercussion.com/#/~search/keywords/"+encodeURIComponent(d)),_gaq.push(["_trackEvent","search","keywordSearch",d])},onRemoveSearch:function(){b.removeSearch(),$('input[name="searchQuery"]').val("").change()},onFilterAttribute:function(a,c){var d=$(c.selector).attr("name").replace("[]","");b.updateHistoryMap(d),$(c.selector).is(":checked")?b.addFilterAttribute($(c.selector).val()):b.removeFilterAttribute($(c.selector).val());var e=$(c.selector).val().split(":");_gaq.push(["_trackEvent","search","filterAttribute",e[0],e[1]])},onClearAllRefinements:function(){h=[],g.allAttributes="",g.keywords="",b.loadCategory(g.category),_gaq.push(["_trackEvent","search","clearAllRefinements",!0])},onLoadCategory:function(a,c){b.loadCategory($(c.selector).data("path"),!0),c.originalEvent.preventDefault(),f=!1,_gaq.push(["_trackEvent","search","filterCategory",$(c.selector).data("path")])},onDestroyAndLoadCategory:function(a,d){if(f=!1,-1===document.location.href.indexOf("https")){var e=($(d.selector).attr("href")+"#").split("#"),g=(c.controllers.application.parseStateFromHash(e[1])||{}).search||{};g.category=g.category||e[0],h=[],b.loadState(g,null,!0)&&($("html").attr("data-path","").addClass("search-loading"),b.scrollToFirst(),c.controllers.flyout.closeFlyout(),d.originalEvent.preventDefault())}_gaq.push(["_trackEvent","search","browseToCategory",g.category])},onRemoveCategory:function(a,c){for(var d="/"+g.category,e=$(c.selector).data("removepath").split("/"),f=0;f<e.length;f++)e[f].length>0&&(d=(d+"/").replace("/"+e[f]+"/","/"));b.loadCategory(d.replace(/\/{1,}/g,"/","/"),!0),_gaq.push(["_trackEvent","search","removeCategory",e])},onNextPage:function(){b.paginate("next"),_gaq.push(["_trackEvent","search","paginate","next"])},onPreviousPage:function(){b.paginate("prev"),_gaq.push(["_trackEvent","search","paginate","previous"])},onSort:function(a,c){g.sort=$(c.selector).val(),b.paginate("first"),_gaq.push(["_trackEvent","search","sort",$(c.selector).val()])},onItemsPerPage:function(a,c){g.resultsPerPage=$(c.selector).val(),b.paginate("first"),_gaq.push(["_trackEvent","search","resultsPerPage",$(c.selector).val()])},onShowCompactView:function(){b.changeView("gridView"),b.pushState(),_gaq.push(["_trackEvent","search","changeView","compact"])},onShowDetailsView:function(){b.changeView("listView"),b.pushState(),_gaq.push(["_trackEvent","search","changeView","detailed"])}},application:{onStateChange:function(){c.controllers.application.pullState(b)?(f=!1,b.loadCurrentState()):f||document.location.reload()},onReady:function(){(c.controllers.application.pullState(b)||((LSP.config||{}).search||{}).loadCurrentState)&&b.loadCurrentState()},onInit:function(){},onContextChangeEnterPhone:function(){b.changeView("listView")}}},assets:{},updateHistoryMap:function(b){require(["vendors/form2js/form2js"],function(){var c=a.formToObject($("#refinementForm")[0]),d=$.grep(h,function(a){return a.name===b}).length;d?h[h.length-1].name!==b&&(h[h.length-1].displayState="static"):h.push({name:b,displayState:"temporary"});for(var e=0;e<h.length-1;e++)h[e].displayState="static";for(var e=0;e<h.length;e++){var f=h[e].name;c[f]||h.splice(e,1)}})},loadCurrentState:function(){b.loadState(c.controllers.application.pullState(b),{preventPushState:!f})},getState:function(){var a=$.extend({},g);return c.controllers.application.hasPushState()&&delete a.category,a.allAttributes={value:(a.allAttributes||"").replace(/[\/]/g,","),uriEncode:!1},a.path=g.category,0===a.allAttributes.value.length&&delete a.allAttributes,a},pushState:function(){var a=b.getState();return c.controllers.application.pushState(b,a,f)},pullState:function(a){var b=document.location.pathname.replace(/\?.*/,""),c={page:"1",view:(LSP.settings||{}).defaultSearchView||"listView"};return g=$.extend({},c,a||{}),g.allAttributes=((g||{}).allAttributes||"").replace(/[\|\,]/g,"/"),b.indexOf(".html")>-1&&!g.category?g.category=b.substring(0,b.lastIndexOf("/")):g.category||(g.category=b),g.category="/"===g.category?"":g.category,g.category=g.category.replace(/^\//,""),g.category=g.category.replace(/\/$/,""),g.keywords&&(g.keywords=decodeURIComponent(g.keywords).replace(/\-/g," ").replace(/^ /,"")),g},loadState:function(c,d,e){var h=$.extend({},g);return b.pullState(c),$('input[name="searchQuery"]').val(g.keywords),a.isEqual(h,g)?!1:(e&&(f=!1),b.search(null,d),!0)},search:function(a,c){var f={action:"advisor",method:"CA_Search",keywords:null===a?g.keywords:a};return d.request(b,"search",$.extend({},g,{isSingleSelect:e},f),c).done(function(a){a.response&&(1!==((((a.response||{}).source||{}).products||{}).items||[]).length||((((a.response||{}).source||{})._lsp||{}).query||{}).assumedQuery?b.renderPage(a.response.source):document.location.replace(a.serverResponse.source.products.items[0].Item_URL))})},removeSearch:function(){var a={action:"advisor",method:"CA_BreadcrumbRemove"};return delete g.keywords,d.request(b,"removeSearch",$.extend({},g,{isSingleSelect:e},a)).done(function(a){b.renderPage(a.response.source)})},loadCategory:function(a,c){var f={action:"advisor",method:"CA_CategoryExpand",category:c?a:g.category.replace(/\/$/,"")+"/"+a};return d.request(b,"loadCategory",$.extend({},g,{isSingleSelect:e},f)).done(function(a){b.renderPage(a.response.source)})},addFilterAttribute:function(a){var c={action:"advisor",method:"CA_AttributeSelected",attribute:a};return d.request(b,"filter",$.extend({},g,{isSingleSelect:e},c)).done(function(a){b.renderPage(a.response.source)})},removeFilterAttribute:function(a){var c={action:"advisor",method:"CA_BreadcrumbRemove",allAttributes:g.allAttributes.replace(a,"").replace(";;",";").replace("//","/").replace(/((\/;)|(;\/))/g,"/").replace(/^[\/;]/,"").replace(/[;\/]$/,"")};return d.request(b,"removeFilter",$.extend({},g,{isSingleSelect:e},c)).done(function(a){b.renderPage(a.response.source)})},paginate:function(a){var c={action:"navbar",method:$.isNumeric(a)?"page"+a:a,currentPage:g.page};return d.request(b,"paginate",$.extend({},g,c)).done(function(a){b.renderSummary(a.response.source),b.renderProducts(a.response.source)})},changeView:function(a){("gridView"===a||"listView"===a)&&($("#resultsContainer").removeClass("gridView").removeClass("listView").addClass(a),g.view=a,$(".thumbnail img[data-src][data-lazy-handled]").unveil())},renderPage:function(d){if(!$(".page-search").length){$(".page-generic").length||$("#div__body").addClass("page-generic");var e=a.parseMicroTemplate("templates-search-page",{}),f=$.parseHTML(e);$(".page-generic").after(f).hide(),c.controllers.application.attachEvents($(".page-search"))}b.changeView(g.view),$(".page-search").show(),$(".page-generic").hide(),b.renderSummary(d),b.renderSelectedRefinements(d),b.renderRefinements(d),b.renderProducts(d)},scrollToFirst:function(){return a.scrollTo($("body"))},renderSummary:function(b){var d=(g.category,((b.products||{}).itemDescription||{}).currentPage),e=((b.products||{}).itemDescription||{}).pageCount,f=a.parseMicroTemplate("templates-search-breadcrumbs",$.extend({},b)),h=$("#breadcrumbs").html(f);c.controllers.application.attachEvents(h),h.is(":has(button)")?h.parent(".breadcrumbs").removeClass("hide"):h.parent(".breadcrumbs").addClass("hide");var i=a.parseMicroTemplate("templates-search-title",$.extend({},b));c.controllers.application.attachEvents($("#searchTitle").html(i)),$(".currentPageNumber").html(d),$(".totalPages").html(e),$(".numberOfResults").html(((b.products||{}).itemDescription||{}).totalItems);var j=((b.products||{}).itemDescription||{}).sortOrder||"default";$('select[data-action="sort"]').val(j.indexOf("EAScore")>-1?"default":j),$('select[data-action="itemsPerPage"]').val(((b.products||{}).itemDescription||{}).resultsPerPage),1===d?$('*[data-action="previousPage"]').css("visibility","hidden"):$('*[data-action="previousPage"]').css("visibility","visible"),d===e?$('*[data-action="nextPage"]').css("visibility","hidden"):$('*[data-action="nextPage"]').css("visibility","visible");var k=[];b.navPath._lsp.searchNode&&k.push('"'+b.navPath._lsp.searchNode.englishName+'"');for(var l=b.navPath._lsp.refinementNodes.length-1;l>=0;l--)k.push(b.navPath._lsp.refinementNodes[l].value);document.title=$("#pageName").text()+(k.length?" : "+k.join(", "):"")+" | Lone Star Percussion",$("html").attr("data-title",document.title),_gaq.push(["_trackPageview",g.category+(g.keywords?"/?search="+g.keywords:"")])},renderSelectedRefinements:function(b){var d=a.parseMicroTemplate("templates-search-selectedRefinements",$.extend({},b));c.controllers.application.attachEvents($("#selectedRefinements").html(d))},renderRefinements:function(b){for(var d=0;d<h.length;d++)for(var e=0;e<b.attributes._lsp.cached.length;e++){var f=b.attributes._lsp.cached[e];if((h[d]||{}).name===f.name){b.attributes._lsp.cached[e].displayState=h[d].displayState;break}}var g=a.parseMicroTemplate("templates-search-refinements",$.extend({},b));c.controllers.application.attachEvents($("#searchRefinements").html(g).show()),(b.attributes._lsp.cached||{}).length?$("#searchRefinements").removeClass("empty"):$("#searchRefinements").addClass("empty")},renderProducts:function(d){var e=a.parseMicroTemplate("templates-search-entries",$.extend({},d));c.controllers.application.attachEvents($("#searchEntries").html(e)),b.changeView(g.view)},renderFatalError:function(a){_gaq.push(["_trackEvent","search","error","fatalError : "+a.serverResponse.status+" : "+a.serverResponse.statusText]),receievedMessage=(a.response.errorMsg||"").length>0?" "+a.response.errorMsg+" ":" ",alert("Something has gone wrong with our network connection to our database."+receievedMessage+"Sorry about that!")}}}())})}();