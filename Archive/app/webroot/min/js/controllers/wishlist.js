!function(){define(["utilities/global","controllers/application"],function(){window.parsePrice=function a(b,c){b=Math.round(100*b)/100;var d=parseInt(b/1e3),e=Math.round(b%1e3*100)/100;if(100>e&&(e=10>e?"00"+e:"0"+e),d>0&&(d=a(d,!0),b=d+","+e),!c){if(b+="",-1!=b.indexOf(".")){var f=b.substring(b.indexOf(".")+1,b.length);1==f.length&&(b+="0")}else b+=".00";return"$"+b}return b},window.getNumber=function(a){return a+="",-1!=a.indexOf("$")&&(a=a.substring(a.indexOf("$")+1).replace(",","").replace(" ","")),parseFloat(a)},window.calcSaves=function(a,b){var a=getNumber(a),b=getNumber(b),c=a-b,d=Math.round(1e4*c/a)/100;return c>0?d+"%":!1},window.addToWishlist=function(a){if(a.messages.hide(),""!=a.customer){var b="";if(0===a.options.length||a.options.length>0&&a.options.find("option:selected").length===a.options.length&&(a.item.val()||"").length>0){a.options.each(function(){var a=(this.id,$(this).attr("name")),c=$(this).find("option:selected"),d=(c.val(),c.text());b+=a+"="+a+"=="+escape(d)+"="+escape(d)+";"});var c="/app/site/hosting/scriptlet.nl?script=customscript_add_item_wishlist&deploy=customdeploy_add_item_wishlist&i="+a.item.val()+"&j="+a.customer+"&q=1&s="+a.site+"&o="+b;$.getScript(c,function(){$("#add-wishlist").hide(),a.messages.eq(0).show()})}else $("#add-wishlist").removeClass("loading"),a.messages.eq(2).show()}else a.messages.eq(1).show()},window.drawWishlist=function(a,b,c,d,e,f,g,h,i,j,k,l){var m={id:a,url:b,thumbnailUrl:c,name:unescape(d),price:e,quantity:f,options:unescape(g),comments:unescape(h),msrp:i,stockMessage:unescape(j),mpn:unescape(k),behavior:unescape(l)};$("table.wishlist.table tbody").append(LSP.utilities.parseMicroTemplate("templates-wishlistItem",m)).parent("table").show(),$("table.wishlist .comments textarea").off("keyup.wishlist").on("keyup.wishlist",function(){$(this).val().length>0&&($(".wish-update",this.parentNode).fadeIn(),$(".wish-text-saved",this.parentNode).hide())})},window.wishlistReady=function(a){-1!=document.location.href.indexOf("austintest")&&alert(a)},window.wishStatusText=function(a){"T"==a?($('input[type="radio"][name="isPublic"][value="true"]').attr("checked",!0),$("#wishlistStatus").removeClass("loading").html("public")):($('input[type="radio"][name="isPublic"][value="false"]').attr("checked",!0),$("#wishlistStatus").removeClass("loading").html("private"))},window.myWishlist=function(a){if(""!=a.customer){a.messages.filter(".loggedIn").show();var b=new Date,c="/app/site/hosting/scriptlet.nl?script=customscript_show_my_wishlist&deploy=customdeploy_show_my_wishlist&j="+a.customer+"&s=lonestarpercussion&random="+Math.random()*b.getTime();$("table.wishlist.table tbody").addClass("loading small"),$.getScript(c,function(c){if($("#wish-info").show(),""==c)a.messages.filter(".emptyWishlist").show(),$("#wishlistStatus").html("empty"),$("table.wishlist.table tbody").removeClass("loading");else{$("table.wishlist.table tbody").removeClass("loading");var d=$("#wishlist-wrapper tbody"),e=$("#wishlist-messages > div"),f=($("#wish-pub"),null),g=c.substring(c.indexOf("Ready('")+7);g=g.substring(0,g.indexOf("'")),wishStatusText(g),$('input[type="radio"][name="isPublic"]').click(function(){var c=$(this).val().substr(0,1).toUpperCase();f&&clearTimeout(f);var d="/app/site/hosting/scriptlet.nl?script=customscript_update_wishlist_public&deploy=customdeploy_update_wishlist_public&j="+a.customer+"&p="+c+"&random="+Math.random()*b.getTime();$("#wishlistStatus").addClass("loading small"),$.getScript(d,function(){wishStatusText(c)})}),$(function(){d.find(".wish-remove").click(function(){var b=$(this),c=$(this).data("id"),f=$(this).data("options");return $.getScript("/app/site/hosting/scriptlet.nl?script=customscript_remove_item_wishlist&deploy=customdeploy_remove_item_wishlist&j="+a.customer+"&i="+c+"&o="+f,function(){b.closest("tr").fadeOut(function(){$(this).remove(),0==d.find(".wishlistItem").length&&(e.filter(".emptyWishlist").show(),d.closest("table.wishlist").hide(),d.closest("h2").hide())})}),!1}),d.find(".wish-update").click(function(){var b=$(this).parent(),c=$(this).data("id"),d=escape(b.parent().find("textarea").val()),e="/app/site/hosting/scriptlet.nl?script=customscript_update_wishlist_comments&deploy=customdeploy_update_wishlist_comments&i="+c+"&j="+a.customer+"&t="+d+"&o="+$(this).data("options");return $.getScript(e,function(){var a=b.parent().find(".wish-text-saved");a.fadeIn(),$(".wish-update",b).hide()}),!1})})}})}else a.messages.hide().filter(".notLoggedIn").show()},window.addCustomer=function(a,b,c,d){var e="<div class='wish-result'>";e+="<a href='#'>"+unescape(b)+" "+unescape(c)+" - "+d+"</a>",e+="<input type='hidden' value='"+a+"' />",e+="</div>",$("#wish-search-results").append(e)},window.searchWishlist=function(a){var b=new Date;$.getScript("/app/site/hosting/scriptlet.nl?script=customscript_search_wishlist&deploy=customdeploy_search_wishlist&st="+a.searchText+"&random="+Math.random()*b.getTime(),function(){a.messages.hide(),$(function(){var b=$("#wishlist-wrapper"),c=$("#wish-search-results");0==c.find(".wish-result").length?a.messages.eq(2).show():(a.messages.eq(4).show(),c.find("a").click(function(){a.messages.eq(7).hide();var c=$(this).text(),d=LSP.utilities.cleanTrailing(c.substr(0,c.indexOf(" - ")));0===d.length&&(d=c.substr(c.indexOf(" - ")+3,300)),$(this).parent().siblings().remove(),$("h2").html("Wishlist for "+d).show(),b.hide().find("tbody tr:not(#wish-item-template)").remove();var e=$(this).next().val();return $.getScript("/app/site/hosting/scriptlet.nl?script=customscript_show_my_wishlist&deploy=customdeploy_show_my_wishlist&j="+e+"&s="+a.site,function(){b.find("tbody tr:not(#wish-item-template)").length>0?b.show().find(".wish-add-cart").click(function(){var b=$(this).parent(),c=b.find(".wish-id").val(),d=b.find(".wish-qty").val(),e=b.find(".wish-options-values").val(),f="/app/site/backend/additemtocart.nl?c="+a.account+"&buyid="+c+"&qty="+d+e+"&continue=/Search-Wishlist?searchtext="+a.searchText;return document.location=f,!1}):a.messages.eq(7).show()}),!1}),a.messages.eq(6).show())})})},function(){var a=window.LSP.utilities;a.register("controller","wishlist",function(){{var a={};window.LSP}return a={name:"wishlist",events:{application:{onReady:function(){(LSP.config||{}).wishlist&&myWishlist(LSP.config.wishlist.myWishlistSettings);var a=$("#search-wish"),b=$("#search-wish-text"),c=$(".wishlist-messages > div");b.keyup(function(b){13==b.keyCode&&a.trigger("click")}),a.off("wishlist").on("click.wishlist",function(){c.hide(),$(".resultsHeader").hide(),$("#wish-search-results").html(""),$("#wishlist-wrapper").hide().find("tbody tr:not(#wish-item-template)").remove(),""!=b.val()?b.val().length>2?(c.eq(1).show(),searchWishlist({account:"665798",messages:c,searchText:b.val(),site:"lonestarpercussion"})):c.eq(5).show():c.eq(0).show()});var d=window.location.href;if(-1!=d.indexOf("searchtext")){var e=d.substring(d.indexOf("searchtext")+11);e=e.substring(0,e.indexOf("&")),b.val(e),a.click()}}}},assets:{}}}())}()})}();